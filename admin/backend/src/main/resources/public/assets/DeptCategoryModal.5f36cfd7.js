var I=(e,t,s)=>new Promise((n,u)=>{var c=o=>{try{i(s.next(o))}catch(l){u(l)}},C=o=>{try{i(s.throw(o))}catch(l){u(l)}},i=o=>o.done?n(o.value):Promise.resolve(o.value).then(c,C);i((s=s.apply(e,t)).next())});import{c as k,ap as D,a as M,v as R,s as h,ar as p,o as B,j as S,y as f,n as d,z as L,t as O,as as E}from"./index.f8b6fa94.js";import{C as P}from"./index.20e31dae.js";/* empty css              */import{D as $}from"./index.bec743a7.js";import{B as N,a as V}from"./index.0c1d45ad.js";import{B as x}from"./TableImg.9ee05584.js";import{T as F}from"./index.26a558af.js";import{u as U}from"./useTable.1012c757.js";import{a as z,s as K,b as Y}from"./dept.e04c0af6.js";import{i as j}from"./isEmpty.46a5c532.js";import{C as q}from"./index.b3bb861d.js";import{R as G}from"./index.8ffde185.js";import"./Checkbox.572a0527.js";import"./useWindowSizeFn.268c75c1.js";import"./FullscreenOutlined.8522ef3f.js";import"./index.1423091e.js";import"./index.961d34d0.js";import"./eagerComputed.d49f1c93.js";import"./BasicForm.eebb9e8d.js";/* empty css               */import"./index.e501ff06.js";import"./index.5c9fe55c.js";import"./index.12c7904d.js";import"./index.345349a2.js";import"./get.12156efd.js";import"./index.1efac556.js";import"./_baseEach.2d110e96.js";import"./_baseIteratee.07173297.js";import"./_baseProperty.2030e337.js";import"./DeleteOutlined.c60a3e36.js";import"./index.65e8311b.js";import"./useRefs.25abb648.js";import"./Form.42748d5d.js";import"./Row.0bd81407.js";import"./useFlexGapSupport.816f6ec3.js";import"./toInteger.443f55d3.js";import"./Col.b99e5aca.js";import"./useSize.3eb1ac1b.js";import"./index.5ddb8e93.js";import"./index.ae9da7c5.js";import"./uniqBy.ed970345.js";import"./useForm.74156ad2.js";import"./index.7cdcb74e.js";import"./index.fd9bf113.js";import"./index.7880b903.js";import"./onMountedOrActivated.73153770.js";import"./useContentViewHeight.a5b3eda6.js";import"./ArrowLeftOutlined.2c75bf82.js";import"./index.fad130bb.js";import"./transButton.7ec2a071.js";import"./uuid.2b29000c.js";import"./merge.a3bec796.js";import"./sortable.esm.c20789c1.js";import"./RedoOutlined.53735e83.js";import"./index.29f29e0d.js";import"./scrollTo.7fe5bdbc.js";import"./index.55183d61.js";import"./index.a4095fd7.js";import"./index.c3665e07.js";import"./download.3a5cff84.js";import"./base64Conver.08b9f4ec.js";const{t:g}=k(),H=[{title:g("AccessControl.dept.id"),dataIndex:"id",width:50},{title:g("AccessControl.cate.selected"),dataIndex:"selected",edit:!0,editRow:!1,editable:!1,editComponent:"Checkbox",editComponentProps:{},editValueMap:e=>e?"Y":"N",width:200},{title:g("AccessControl.cate.contain_child"),dataIndex:"containChild",edit:!0,editRow:!1,editable:!1,editComponent:"Checkbox",editComponentProps:{},editValueMap:e=>e?"Y":"N",width:200},{title:g("AccessControl.cate.name"),dataIndex:"name",width:150,align:"left"}],J=M({name:"DeptCategoryManagement",components:{BasicTable:x,BasicModal:N,TableAction:F,Checkbox:P,Col:q,Divider:$,Row:G},setup(){const{t:e}=k(),t=R({deptId:null,cateId:null,parentCate:!1}),s=h([]),n=h(!1),u=h(null),c=h(!1);function C(){return I(this,null,function*(){return z(t)})}const[i,{reload:o}]=U({isTreeTable:!1,api:C,columns:H,rowKey:"id",pagination:!1,striped:!1,useSearchForm:!1,showTableSetting:!1,bordered:!0,showIndexColumn:!1,canResize:!1,immediate:!0,handleSearchInfoFn(a){return a},actionColumn:{width:80,title:e("common.action"),dataIndex:"action",slots:{customRender:"action"}}}),[l,{setModalProps:m,closeModal:b}]=V(a=>I(this,null,function*(){c.value=a.record.ownsAllCategory,t.deptId=a.record.id,t.cateId=null,yield o()}));function w(){b()}function r(a){t.cateId=a.parentId,t.parentCate=!0,o()}function A(a){t.cateId=a.id,t.parentCate=!1,o()}function T({record:a,key:y,value:_}){try{m({confirmLoading:!0}),n.value=!0,K(t.deptId,[{id:a.id,selected:y==="selected"?_:a.selected,containChild:y==="containChild"?_:a.containChild}])}finally{m({confirmLoading:!1}),n.value=!1}}function v(){try{m({confirmLoading:!0}),n.value=!0,Y(t.deptId,c.value)}finally{m({confirmLoading:!1}),n.value=!1}}return{t:e,isEmpty:j,loading:n,deptCateTable:u,ownsAllCategory:c,registerTable:i,registerModal:l,handleOk:w,handleUp:r,handleDown:A,beforeEditSubmit:T,handleOwnsAllCategory:v,checkedKeys:s,searchInfo:t}}});function Q(e,t,s,n,u,c){const C=p("Checkbox"),i=p("Col"),o=p("Divider"),l=p("TableAction"),m=p("BasicTable"),b=p("Row"),w=p("BasicModal");return B(),S(w,E(e.$attrs,{onRegister:e.registerModal,title:e.t("AccessControl.dept.edit_category"),onOk:e.handleOk,cancelButtonProps:{hidden:!0},width:800,"min-height":400}),{default:f(()=>[d(b,null,{default:f(()=>[d(i,{span:24},{default:f(()=>[d(C,{checked:e.ownsAllCategory,"onUpdate:checked":t[0]||(t[0]=r=>e.ownsAllCategory=r),onChange:e.handleOwnsAllCategory},{default:f(()=>[L(O(e.t("AccessControl.dept.own_all_cate")),1)]),_:1},8,["checked","onChange"])]),_:1}),d(o),d(i,{span:24},{default:f(()=>[d(m,{ref:"deptCateTable",onRegister:e.registerTable,searchInfo:e.searchInfo,beforeEditSubmit:e.beforeEditSubmit},{action:f(({record:r})=>[d(l,{"stop-button-propagation":!0,actions:[{icon:"bi:file-arrow-up",onClick:e.handleUp.bind(null,r),ifShow:r.parentId!=null},{icon:"bi:file-arrow-down",onClick:e.handleDown.bind(null,r),ifShow:!r.isLeaf}]},null,8,["actions"])]),_:1},8,["onRegister","searchInfo","beforeEditSubmit"])]),_:1})]),_:1})]),_:1},16,["onRegister","title","onOk"])}var it=D(J,[["render",Q]]);export{it as default};
