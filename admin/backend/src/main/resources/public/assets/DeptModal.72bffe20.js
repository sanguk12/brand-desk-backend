var F=Object.defineProperty;var v=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var y=(e,a,o)=>a in e?F(e,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[a]=o,I=(e,a)=>{for(var o in a||(a={}))R.call(a,o)&&y(e,o,a[o]);if(v)for(var o of v(a))T.call(a,o)&&y(e,o,a[o]);return e};var g=(e,a,o)=>new Promise((l,r)=>{var u=n=>{try{d(o.next(n))}catch(c){r(c)}},p=n=>{try{d(o.throw(n))}catch(c){r(c)}},d=n=>n.done?l(n.value):Promise.resolve(n.value).then(u,p);d((o=o.apply(e,a)).next())});import{B as W,a as N}from"./index.c6d9e38a.js";import{B as Y}from"./BasicForm.6899d0a5.js";import{u as $}from"./useForm.b2949832.js";import{c as B,bQ as L,ap as O,a as U,cT as j,s as A,i as M,f as V,ar as b,o as q,j as G,y as S,n as _,as as H,fy as z}from"./index.9b68f3a5.js";import{T as Q}from"./index.6344e34d.js";import{c as E,d as J}from"./dept.1369de14.js";import{f as K}from"./pickDeep.63c4da24.js";const{t}=B(),ie=[{title:t("AccessControl.dept.id"),dataIndex:"id",width:50},{title:t("AccessControl.dept.name"),dataIndex:"name",width:150,align:"left"},{title:t("AccessControl.dept.ownsAllCategory"),dataIndex:"ownsAllCategory",width:120,customRender:({record:e})=>~~e.ownsAllCategory===1?"Y":"N"},{title:t("AccessControl.dept.ownsAllPage"),dataIndex:"ownsAllPage",width:120,customRender:({record:e})=>~~e.ownsAllPage===1?"Y":"N"},{title:t("AccessControl.dept.ownsAllConfig"),dataIndex:"ownsAllConfig",width:120,customRender:({record:e})=>~~e.ownsAllConfig===1?"Y":"N"},{title:t("AccessControl.dept.manager"),dataIndex:"managerName"},{title:t("AccessControl.dept.description"),dataIndex:"description"},{title:t("AccessControl.dept.status"),dataIndex:"status",customRender:({record:e})=>{const o=~~e.status===1,l=o?"green":"red",r=t(o?"AccessControl.dept.enabled":"AccessControl.dept.disabled");return L(Q,{color:l},()=>r)}},{title:t("AccessControl.dept.createDate"),dataIndex:"createDate",format:"date|YYYY-MM-DD HH:mm:ss",width:180}],pe=[{field:"name",label:t("AccessControl.dept.name"),component:"Input",colProps:{span:8}},{field:"status",label:t("AccessControl.dept.status"),component:"Select",componentProps:{options:[{label:t("AccessControl.dept.enabled"),value:1},{label:t("AccessControl.dept.disabled"),value:0}]},colProps:{span:8}}],X=[{field:"id",label:t("AccessControl.role.id"),component:"Input",show:!1},{field:"name",label:t("AccessControl.dept.name"),labelWidth:200,component:"Input",required:!0},{field:"status",label:t("AccessControl.dept.status"),labelWidth:200,component:"RadioButtonGroup",defaultValue:1,componentProps:{options:[{label:t("AccessControl.dept.enabled"),value:1},{label:t("AccessControl.dept.disabled"),value:0}]},required:!0},{field:"parentId",label:t("AccessControl.dept.parent"),labelWidth:200,component:"TreeSelect",componentProps:{fieldNames:{label:"name",key:"id",value:"id"},getPopupContainer:()=>document.body}},{field:"managerId",component:"Select",label:t("AccessControl.dept.manager"),labelWidth:200,slot:"userSearch",colProps:{span:24}},{field:"ownsAllCategory",component:"Checkbox",label:t("AccessControl.dept.ownsAllCategory"),labelWidth:200,colProps:{span:24}},{field:"ownsAllPage",component:"Checkbox",label:t("AccessControl.dept.ownsAllPage"),labelWidth:200,colProps:{span:24}},{field:"ownsAllConfig",component:"Checkbox",label:t("AccessControl.dept.ownsAllConfig"),labelWidth:200,colProps:{span:24}},{label:t("AccessControl.dept.description"),labelWidth:200,field:"description",component:"InputTextArea"}],Z=U({name:"DeptModal",components:{BasicModal:W,BasicForm:Y,ASelect:j},emits:["success","register"],setup(e,{emit:a}){const{t:o}=B(),l=A(!0),r=s=>g(this,null,function*(){const i=yield z({name:s});w.value=i.list.map(m=>({label:`${m.nickname}`,value:m.id}))}),u=s=>{P.value=s},[p,{resetFields:d,setFieldsValue:n,updateSchema:c,validate:f}]=$({labelWidth:100,schemas:X,showActionButtonGroup:!1}),[C,{setModalProps:h,closeModal:D}]=N(s=>g(this,null,function*(){yield d(),h({confirmLoading:!1}),l.value=!!(s!=null&&s.isUpdate);const i=yield E();M(l)&&(yield n(I({},s.record)),K(i,function(m){return m.disabled=s.record.id===m.id,!0},{childrenPath:["children"]}),yield r(s.record.managerName)),yield c({field:"parentId",componentProps:{treeData:i}})})),x=V(()=>M(l)?o("AccessControl.dept.edit"):o("AccessControl.dept.add"));function k(){return g(this,null,function*(){try{const s=yield f();h({confirmLoading:!0});const i=yield J(s);D(),a("success")}finally{h({confirmLoading:!1})}})}const w=A([]),P=A();return{t:o,registerModal:C,registerForm:p,getTitle:x,handleSubmit:k,handleManagerSearch:r,handleManagerChange:u,managerList:w,managerId:P}}});function ee(e,a,o,l,r,u){const p=b("a-select"),d=b("BasicForm"),n=b("BasicModal");return q(),G(n,H(e.$attrs,{onRegister:e.registerModal,title:e.getTitle,onOk:e.handleSubmit}),{default:S(()=>[_(d,{onRegister:e.registerForm},{userSearch:S(({model:c,field:f})=>[_(p,{value:c[f],"onUpdate:value":C=>c[f]=C,showSearch:"",allowClear:"",placeholder:e.t("AccessControl.dept.search_user"),style:{width:"200px"},"default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":null,options:e.managerList,onSearch:e.handleManagerSearch,onChange:e.handleManagerChange},null,8,["value","onUpdate:value","placeholder","options","onSearch","onChange"])]),_:1},8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}var te=O(Z,[["render",ee]]),me=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));export{te as D,me as a,ie as c,pe as s};
