var _=(w,f,r)=>new Promise((l,m)=>{var t=a=>{try{i(r.next(a))}catch(u){m(u)}},g=a=>{try{i(r.throw(a))}catch(u){m(u)}},i=a=>a.done?l(a.value):Promise.resolve(a.value).then(t,g);i((r=r.apply(w,f)).next())});import{a as T,I as C,c as $,b as P,r as A,s as F,v as K,f as M,i as e,o as U,h as V,w as R,x as k,n as s,y as n,B as I,z as L,t as h,C as O,F as q,D as G}from"./index.0a8b89be.js";/* empty css              *//* empty css               */import{u as W,a as j,L as D,_ as H,b as J}from"./LoginFormTitle.742e7ff0.js";import{F as b}from"./Form.b63e2253.js";import{C as Q}from"./index.25fd638a.js";import{R as X}from"./index.624fc280.js";import"./Row.0bf79b77.js";import"./useFlexGapSupport.4f13b498.js";import"./_baseIteratee.b2478045.js";import"./get.40773c6b.js";import"./_baseProperty.2030e337.js";import"./toInteger.728c1e91.js";import"./Col.a8b0ef91.js";import"./useSize.d9666d99.js";const fe=T({name:"LoginForm",setup(w){const f=Q,r=X,l=b.Item,m=C.Password,{t}=$(),{notification:g,createErrorModal:i}=G(),{prefixCls:a}=P("login"),u=A(),{setLoginState:E,getLoginState:z}=W(),{getFormRules:B}=j(),v=F(),y=F(!1),c=K({account:"admin",password:"admin"}),{validForm:N}=J(v),x=M(()=>e(z)===D.LOGIN);function S(){return _(this,null,function*(){const p=yield N();if(!!p)try{y.value=!0;const o=yield u.login({password:p.password,username:p.account,mode:"none"});o&&g.success({message:t("sys.login.loginSuccessTitle"),description:`${t("sys.login.loginSuccessDesc")}: ${o.realName}`,duration:3})}catch(o){i({title:t("sys.api.errorTip"),content:o.message||t("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${a}`)||document.body})}finally{y.value=!1}})}return(p,o)=>(U(),V(q,null,[R(s(H,{class:"enter-x"},null,512),[[k,e(x)]]),R(s(e(b),{class:"p-4 enter-x",model:c,rules:e(B),ref_key:"formRef",ref:v,onKeypress:O(S,["enter"])},{default:n(()=>[s(e(l),{name:"account",class:"enter-x"},{default:n(()=>[s(e(C),{size:"large",value:c.account,"onUpdate:value":o[0]||(o[0]=d=>c.account=d),placeholder:e(t)("sys.login.userName"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),s(e(l),{name:"password",class:"enter-x"},{default:n(()=>[s(e(m),{size:"large",visibilityToggle:"",value:c.password,"onUpdate:value":o[1]||(o[1]=d=>c.password=d),placeholder:e(t)("sys.login.password")},null,8,["value","placeholder"])]),_:1}),s(e(r),{class:"enter-x"},{default:n(()=>[s(e(f),{span:12},{default:n(()=>[s(e(l),{style:{"text-align":"left"}},{default:n(()=>[s(e(I),{type:"link",size:"small",onClick:o[2]||(o[2]=d=>e(E)(e(D).RESET_PASSWORD))},{default:n(()=>[L(h(e(t)("sys.login.forgetPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1}),s(e(l),{class:"enter-x"},{default:n(()=>[s(e(I),{type:"primary",size:"large",block:"",onClick:S,loading:y.value},{default:n(()=>[L(h(e(t)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules","onKeypress"]),[[k,e(x)]])],64))}});export{fe as default};
