var Oe=Object.defineProperty,$e=Object.defineProperties;var Pe=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var Ue=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var ce=(e,t,n)=>t in e?Oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,I=(e,t)=>{for(var n in t||(t={}))Ue.call(t,n)&&ce(e,n,t[n]);if(se)for(var n of se(t))je.call(t,n)&&ce(e,n,t[n]);return e},re=(e,t)=>$e(e,Pe(t));var ie=(e,t,n)=>new Promise((y,b)=>{var S=p=>{try{k(n.next(p))}catch(C){b(C)}},s=p=>{try{k(n.throw(p))}catch(C){b(C)}},k=p=>p.done?y(p.value):Promise.resolve(p.value).then(S,s);k((n=n.apply(e,t)).next())});import{eK as Re,eL as Ve,eM as me,eN as He,eO as Xe,eP as Ye,ei as ze,eo as de,eQ as qe,eR as Ge,eS as Je,eT as Qe,a as Le,s as Ae,eU as We,c as Ze,f as M,X as $,o as F,h as U,i as r,av as et,k as O,j as G,y as j,z as oe,t as ue,dD as tt,q as he,n as A,eV as nt,F as Q,au as at,cd as lt,aw as st,ax as ct,eW as rt,b5 as it,b4 as W,bj as dt,cD as ot,br as ut,eX as ht,bQ as ft,a7 as Z,eY as fe,v as ye,ae as X,dm as yt,ag as gt,aq as J,eZ as kt,ea as pt,a5 as R,aA as St,e_ as Kt,dA as xt,cy as Lt,a$ as At,w as ge,x as ke,bC as bt,as as Ct,e8 as pe,e$ as vt,bo as Se,cz as Et}from"./index.9b68f3a5.js";import{b as Tt}from"./index.6b109d0e.js";import{u as _t}from"./useContextMenu.49129f71.js";import{g as Nt}from"./get.8f01bfdb.js";var Bt=200;function wt(e,t,n,y){var b=-1,S=He,s=!0,k=e.length,p=[],C=t.length;if(!k)return p;n&&(t=Re(t,Ve(n))),y?(S=Xe,s=!1):t.length>=Bt&&(S=Ye,s=!1,t=new me(t));e:for(;++b<k;){var c=e[b],o=n==null?c:n(c);if(c=y||c!==0?c:0,s&&o===o){for(var a=C;a--;)if(t[a]===o)continue e;p.push(c)}else S(t,o,y)||p.push(c)}return p}var Dt=ze(function(e,t){return de(e)?wt(e,qe(t,1,de,!0)):[]}),Ft=Dt;function Mt(e){for(var t=-1,n=e==null?0:e.length,y={};++t<n;){var b=e[t];y[b[0]]=b[1]}return y}function ee(e,t){return t?typeof t=="string"?` ${e}--${t}`:Array.isArray(t)?t.reduce((n,y)=>n+ee(e,y),""):Object.keys(t).reduce((n,y)=>n+(t[y]?ee(e,y):""),""):""}function It(e){return(t,n)=>(t&&typeof t!="string"&&(n=t,t=""),t=t?`${e}__${t}`:e,`${t}${ee(t,n)}`)}function be(e){return[It(`${Ge}-${e}`)]}const Ke=Symbol(),xe=Symbol();function Ot(e,t){if(!Je(e)||!!e[xe])return e;const{values:n,required:y,default:b,type:S,validator:s}=e,k=n||s?p=>{let C=!1,c=[];if(n&&(c=[...n,b],C||(C=c.includes(p))),s&&(C||(C=s(p))),!C&&c.length>0){const o=[...new Set(c)].map(a=>JSON.stringify(a)).join(", ");Qe(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${o}], got value ${JSON.stringify(p)}.`)}return C}:void 0;return{type:typeof S=="object"&&Object.getOwnPropertySymbols(S).includes(Ke)?S[Ke]:S,required:!!y,default:b,validator:k,[xe]:!0}}const $t=e=>Mt(Object.entries(e).map(([t,n])=>[t,Ot(n,t)]));var T=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(T||{});const Pt=["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],Ut=$t({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1}}),jt={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},Rt=Le({name:"TreeHeader",props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search"],setup(e,{emit:t}){const n=e,y=Ae(""),[b]=be("tree-header"),S=We(),{t:s}=Ze(),k=M(()=>{const a=S.headerTitle||n.title;return["mr-1","w-full",{["ml-5"]:a}]}),p=M(()=>{const{checkable:a}=n,i=[{label:s("component.tree.expandAll"),value:T.EXPAND_ALL},{label:s("component.tree.unExpandAll"),value:T.UN_EXPAND_ALL,divider:a}];return a?[{label:s("component.tree.selectAll"),value:T.SELECT_ALL},{label:s("component.tree.unSelectAll"),value:T.UN_SELECT_ALL,divider:a},...i,{label:s("component.tree.checkStrictly"),value:T.CHECK_STRICTLY},{label:s("component.tree.checkUnStrictly"),value:T.CHECK_UN_STRICTLY}]:i});function C(a){var d,h,u,g;const{key:i}=a;switch(i){case T.SELECT_ALL:(d=n.checkAll)==null||d.call(n,!0);break;case T.UN_SELECT_ALL:(h=n.checkAll)==null||h.call(n,!1);break;case T.EXPAND_ALL:(u=n.expandAll)==null||u.call(n,!0);break;case T.UN_EXPAND_ALL:(g=n.expandAll)==null||g.call(n,!1);break;case T.CHECK_STRICTLY:t("strictly-change",!1);break;case T.CHECK_UN_STRICTLY:t("strictly-change",!0);break}}function c(a){t("search",a)}const o=ut(c,200);return $(()=>y.value,a=>{o(a)}),$(()=>n.searchText,a=>{a!==y.value&&(y.value=a)}),(a,i)=>(F(),U("div",{class:he([r(b)(),"flex px-2 py-1.5 items-center"])},[r(S).headerTitle?et(a.$slots,"headerTitle",{key:0}):O("",!0),!r(S).headerTitle&&a.title?(F(),G(r(tt),{key:1,helpMessage:a.helpMessage},{default:j(()=>[oe(ue(a.title),1)]),_:1},8,["helpMessage"])):O("",!0),a.search||a.toolbar?(F(),U("div",jt,[a.search?(F(),U("div",{key:0,class:he(r(k))},[A(r(nt),{placeholder:r(s)("common.searchText"),size:"small",allowClear:"",value:y.value,"onUpdate:value":i[0]||(i[0]=d=>y.value=d)},null,8,["placeholder","value"])],2)):O("",!0),a.toolbar?(F(),G(r(ot),{key:1,onClick:i[1]||(i[1]=dt(()=>{},["prevent"]))},{overlay:j(()=>[A(r(it),{onClick:C},{default:j(()=>[(F(!0),U(Q,null,at(r(p),d=>(F(),U(Q,{key:d.value},[A(r(lt),st(ct({key:d.value})),{default:j(()=>[oe(ue(d.label),1)]),_:2},1040),d.divider?(F(),G(r(rt),{key:0})):O("",!0)],64))),128))]),_:1})]),default:j(()=>[A(r(W),{icon:"ion:ellipsis-vertical"})]),_:1})):O("",!0)])):O("",!0)],2))}}),Vt=({icon:e})=>e?ht(e)?ft(W,{icon:e,class:"mr-1"}):W:null;function mt(e,t){function n(c){const o=[],a=c||r(e),{key:i,children:d}=r(t);if(!d||!i)return o;for(let h=0;h<a.length;h++){const u=a[h];o.push(u[i]);const g=u[d];g&&g.length&&o.push(...n(g))}return o}function y(c){const o=[],a=c||r(e),{key:i,children:d}=r(t);if(!d||!i)return o;for(let h=0;h<a.length;h++){const u=a[h];u.disabled!==!0&&u.selectable!==!1&&o.push(u[i]);const g=u[d];g&&g.length&&o.push(...y(g))}return o}function b(c,o){const a=[],i=o||r(e),{key:d,children:h}=r(t);if(!h||!d)return a;for(let u=0;u<i.length;u++){const g=i[u],E=g[h];c===g[d]?(a.push(g[d]),E&&E.length&&a.push(...n(E))):E&&E.length&&a.push(...b(c,E))}return a}function S(c,o,a){if(!c)return;const i=a||r(e),{key:d,children:h}=r(t);if(!(!h||!d))for(let u=0;u<i.length;u++){const g=i[u],E=g[h];if(g[d]===c){i[u]=I(I({},i[u]),o);break}else E&&E.length&&S(c,o,g[h])}}function s(c=1,o,a=1){if(!c)return[];const i=[],d=o||r(e)||[];for(let h=0;h<d.length;h++){const u=d[h],{key:g,children:E}=r(t),Y=g?u[g]:"",P=E?u[E]:[];i.push(Y),P&&P.length&&a<c&&(a+=1,i.push(...s(c,P,a)))}return i}function k({parentKey:c=null,node:o,push:a="push"}){const i=Z(r(e));if(!c){i[a](o),e.value=i;return}const{key:d,children:h}=r(t);!h||!d||(fe(i,u=>{if(u[d]===c)return u[h]=u[h]||[],u[h][a](o),!0}),e.value=i)}function p({parentKey:c=null,list:o,push:a="push"}){const i=Z(r(e));if(!(!o||o.length<1))if(c){const{key:d,children:h}=r(t);if(!h||!d)return;fe(i,u=>{if(u[d]===c){u[h]=u[h]||[];for(let g=0;g<o.length;g++)u[h][a](o[g]);return e.value=i,!0}})}else for(let d=0;d<o.length;d++)i[a](o[d])}function C(c,o){if(!c)return;const a=o||r(e),{key:i,children:d}=r(t);if(!(!d||!i))for(let h=0;h<a.length;h++){const u=a[h],g=u[d];if(u[i]===c){a.splice(h,1);break}else g&&g.length&&C(c,u[d])}}return{deleteNodeByKey:C,insertNodeByKey:k,insertNodesByKey:p,filterByLevel:s,updateNodeByKey:S,getAllKeys:n,getChildrenKeys:b,getEnabledKeys:y}}function Ht(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Lt(e)}var Jt=Le({name:"BasicTree",inheritAttrs:!1,props:Ut,emits:Pt,setup(e,{attrs:t,slots:n,emit:y,expose:b}){const[S]=be("tree"),s=ye({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),k=ye({startSearch:!1,searchText:"",searchData:[]}),p=Ae([]),[C]=_t(),c=M(()=>{const{fieldNames:l}=e;return I({children:"children",title:"title",key:"key"},l)}),o=M(()=>{let l=re(I(I({blockNode:!0},t),e),{expandedKeys:s.expandedKeys,selectedKeys:s.selectedKeys,checkedKeys:s.checkedKeys,checkStrictly:s.checkStrictly,filedNames:r(c),"onUpdate:expandedKeys":f=>{s.expandedKeys=f,y("update:expandedKeys",f)},"onUpdate:selectedKeys":f=>{s.selectedKeys=f,y("update:selectedKeys",f)},onCheck:(f,x)=>{let K=X(s.checkedKeys);if(yt(K)&&k.startSearch){const{key:v}=r(c);K=Ft(K,P(x.node.$attrs.node[v])),x.checked&&K.push(x.node.$attrs.node[v]),s.checkedKeys=K}else s.checkedKeys=f;const L=X(s.checkedKeys);y("update:value",L),y("check",L,x)},onRightClick:Ee});return gt(l,"treeData","class")}),a=M(()=>k.startSearch?k.searchData:r(p)),i=M(()=>!a.value||a.value.length===0),{deleteNodeByKey:d,insertNodeByKey:h,insertNodesByKey:u,filterByLevel:g,updateNodeByKey:E,getAllKeys:Y,getChildrenKeys:P,getEnabledKeys:Ce}=mt(p,c);function ve(l,f){return!f&&e.renderIcon&&J(e.renderIcon)?e.renderIcon(l):f}function Ee(x){return ie(this,arguments,function*({event:l,node:f}){var B;const{rightMenuList:K=[],beforeRightClick:L}=e;let v={event:l,items:[]};if(L&&J(L)){let N=yield L(f,l);Array.isArray(N)?v.items=N:Object.assign(v,N)}else v.items=K;!((B=v.items)!=null&&B.length)||C(v)})}function V(l){s.expandedKeys=l}function Te(){return s.expandedKeys}function te(l){s.selectedKeys=l}function _e(){return s.selectedKeys}function ne(l){s.checkedKeys=l}function Ne(){return s.checkedKeys}function ae(l){s.checkedKeys=l?Ce():[]}function z(l){s.expandedKeys=l?Y():[]}function Be(l){s.checkStrictly=l}$(()=>e.searchValue,l=>{l!==k.searchText&&(k.searchText=l)},{immediate:!0}),$(()=>e.treeData,l=>{l&&q(k.searchText)});function q(l){if(l!==k.searchText&&(k.searchText=l),y("update:searchValue",l),!l){k.startSearch=!1;return}const{filterFn:f,checkable:x,expandOnSearch:K,checkOnSearch:L,selectedOnSearch:v}=r(e);k.startSearch=!0;const{title:B,key:N}=r(c),w=[];if(k.searchData=kt(r(p),_=>{var m,H;const D=f?f(l,_,r(c)):(H=(m=_[B])==null?void 0:m.includes(l))!=null?H:!1;return D&&w.push(_[N]),D},r(c)),K){const _=pt(k.searchData).map(D=>D[N]);_&&_.length&&V(_)}L&&x&&w.length&&ne(w),v&&w.length&&te(w)}function we(l,f){if(!(!e.clickRowToExpand||!f||f.length===0))if(!s.expandedKeys.includes(l))V([...s.expandedKeys,l]);else{const x=[...s.expandedKeys],K=x.findIndex(L=>L===l);K!==-1&&x.splice(K,1),V(x)}}R(()=>{p.value=e.treeData}),St(()=>{const l=parseInt(e.defaultExpandLevel);l>0?s.expandedKeys=g(l):e.defaultExpandAll&&z(!0)}),R(()=>{s.expandedKeys=e.expandedKeys}),R(()=>{s.selectedKeys=e.selectedKeys}),R(()=>{s.checkedKeys=e.checkedKeys}),$(()=>e.value,()=>{s.checkedKeys=X(e.value||[])}),$(()=>s.checkedKeys,()=>{const l=X(s.checkedKeys);y("update:value",l),y("change",l)}),R(()=>{s.checkStrictly=e.checkStrictly});const De={setExpandedKeys:V,getExpandedKeys:Te,setSelectedKeys:te,getSelectedKeys:_e,setCheckedKeys:ne,getCheckedKeys:Ne,insertNodeByKey:h,insertNodesByKey:u,deleteNodeByKey:d,updateNodeByKey:E,checkAll:ae,expandAll:z,filterByLevel:l=>{s.expandedKeys=g(l)},setSearchValue:l=>{q(l)},getSearchValue:()=>k.searchText};function Fe(l){const{actionList:f}=e;if(!(!f||f.length===0))return f.map((x,K)=>{var v;let L=!0;return J(x.show)?L=(v=x.show)==null?void 0:v.call(x,l):Se(x.show)&&(L=x.show),L?A("span",{key:K,class:S("action")},[x.render(l)]):null})}const Me=M(()=>{const l=Z(a.value);return Kt(l,(f,x)=>{var le;const K=k.searchText,{highlight:L}=r(e),{title:v,key:B,children:N}=r(c),w=ve(f,f.icon),_=Nt(f,v),D=K?_.indexOf(K):-1,m=k.startSearch&&!vt(K)&&L&&D!==-1,H=`color: ${Se(L)?"#f50":L}`,Ie=m?A("span",{class:(le=r(o))!=null&&le.blockNode?`${S("content")}`:""},[A("span",null,[_.substr(0,D)]),A("span",{style:H},[K]),A("span",null,[_.substr(D+K.length)])]):_;return f.title=A("span",{class:`${S("title")} pl-2`,onClick:we.bind(null,f[B],f[N])},[n!=null&&n.title?Et(n,"title",f):A(Q,null,[w&&A(Vt,{icon:w},null),Ie,A("span",{class:S("actions")},[Fe(f)])])]),f}),l});return b(De),()=>{let l;const{title:f,helpMessage:x,toolbar:K,search:L,checkable:v}=e,B=f||K||L||n.headerTitle,N={height:"calc(100% - 38px)"};return A("div",{class:[S(),"h-full",t.class]},[B&&A(Rt,{checkable:v,checkAll:ae,expandAll:z,title:f,search:L,toolbar:K,helpMessage:x,onStrictlyChange:Be,onSearch:q,searchText:k.searchText},Ht(l=xt(n))?l:{default:()=>[l]}),A(At,{spinning:r(e.loading),tip:"Loading..."},{default:()=>[ge(A(bt,{style:N},{default:()=>[A(Tt,Ct(r(o),{showIcon:!1,treeData:Me.value}),null)]}),[[ke,!r(i)]]),ge(A(pe,{image:pe.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[ke,r(i)]])]})])}}});export{Vt as T,Jt as _};
