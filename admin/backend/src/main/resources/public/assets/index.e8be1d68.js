var w=Math.pow;var u=(e,i,t)=>new Promise((n,r)=>{var p=a=>{try{d(t.next(a))}catch(c){r(c)}},o=a=>{try{d(t.throw(a))}catch(c){r(c)}},d=a=>a.done?n(a.value):Promise.resolve(a.value).then(p,o);d((t=t.apply(e,i)).next())});import{fF as F,fN as U,c as y,bQ as T,b4 as v,eb as D,dz as B,ap as Y,a as A,s as z,ar as f,o as M,h as L,n as g,y as C,j,z as H,t as W,k as P,a7 as b,D as R}from"./index.0a8b89be.js";import{B as Z}from"./TableImg.532f196d.js";import{f as $,T as E}from"./index.5a0c5bc8.js";import{u as V}from"./useTable.9784714c.js";import{u as G}from"./upload.360b43d7.js";import{t as K}from"./toInteger.728c1e91.js";import"./index.d06f97b4.js";import"./Checkbox.e21486b4.js";import"./index.281aa2ea.js";import"./index.5f1bdad7.js";import"./eagerComputed.d89357d9.js";import"./BasicForm.90108631.js";/* empty css               *//* empty css              */import"./index.8eadf802.js";import"./index.5485e619.js";import"./index.bd809198.js";import"./index.1b5c222a.js";import"./index.f5f3d84b.js";import"./get.40773c6b.js";import"./index.14314bc3.js";import"./_baseEach.0f4dbd6f.js";import"./_baseIteratee.b2478045.js";import"./_baseProperty.2030e337.js";import"./DeleteOutlined.b8e551ed.js";import"./index.ac3b1fda.js";import"./useRefs.f7f322ba.js";import"./Form.b63e2253.js";import"./Row.0bf79b77.js";import"./useFlexGapSupport.4f13b498.js";import"./Col.a8b0ef91.js";import"./useSize.d9666d99.js";import"./index.14059c69.js";import"./index.04c8d476.js";import"./useWindowSizeFn.64599f54.js";import"./index.25fd638a.js";import"./uniqBy.7ccff7b8.js";import"./index.b536e7c7.js";import"./FullscreenOutlined.9f59f3fc.js";import"./index.624fc280.js";import"./useForm.14189227.js";import"./index.c388f747.js";import"./index.61a163e2.js";import"./index.2c6c45b9.js";import"./onMountedOrActivated.b04887f0.js";import"./useContentViewHeight.2aaec145.js";import"./ArrowLeftOutlined.e3e0fbfd.js";import"./index.01edd6fb.js";import"./transButton.4e1319c6.js";import"./uuid.2b29000c.js";import"./merge.9e7c3f63.js";import"./sortable.esm.c20789c1.js";import"./RedoOutlined.b7e813f0.js";import"./index.4a0da81f.js";import"./scrollTo.9228901a.js";import"./index.d4ddb90b.js";import"./index.b2d27a9d.js";import"./index.bacabee8.js";import"./download.edb4e6af.js";import"./base64Conver.08b9f4ec.js";function Q(e,i,t){return e===e&&(t!==void 0&&(e=e<=t?e:t),i!==void 0&&(e=e>=i?e:i)),e}function q(e,i,t){e=F(e),i=U(i);var n=e.length;t=t===void 0?n:Q(K(t),0,n);var r=t;return t-=i.length,t>=0&&e.slice(t,r)==i}function J(e,i=!1,t=1){const n=i?1e3:1024;if(Math.abs(e)<n)return e+" B";const r=i?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];let p=-1;const o=w(10,t);do e/=n,++p;while(Math.round(Math.abs(e)*o)/o>=n&&p<r.length-1);return e.toFixed(t)+" "+r[p]}const{t:h}=y(),O=[{title:"",dataIndex:"directory",width:150,customRender:({record:e})=>e.directory?T(v,{icon:"clarity:directory-solid",class:"mr-1"}):T(v,{icon:"ant-design:file-text-filled",class:"mr-1"})},{title:h("Content.file.name"),dataIndex:"fileName",width:150,align:"left"},{title:h("Content.file.create_date"),dataIndex:"creationTime",format:(e,i,t)=>i.createDate===null?"":D(i.createDate,"YYYY-MM-DD HH:mm:ss"),width:130},{title:h("Content.file.update_date"),dataIndex:"lastModifiedTime",format:(e,i,t)=>i.createDate===null?"":D(i.createDate,"YYYY-MM-DD HH:mm:ss"),width:130},{title:h("Content.file.size"),dataIndex:"size",format:(e,i,t)=>J(i.size),width:130}];function X(e){return B.get({url:"/api/cmsWebFile/list",params:e})}function ee(e){return B.post({url:"/api/cmsWebFile/zip",params:{path:e}})}function te(e){return B.post({url:"/api/cmsWebFile/unzip",params:{path:e}})}function ie(e){return B.post({url:"/api/cmsWebFile/delete",params:{paths:e}})}const oe=A({name:"ModuleManagement",components:{BasicUpload:$,BasicTable:Z,TableAction:E},setup(){const{t:e}=y(),i=z([]),t=z([]),{createSuccessModal:n}=R();function r(){return u(this,null,function*(){return X({path:t.value.join("/")})})}const[p,{reload:o,expandAll:d,collapseAll:a}]=V({title:e("Content.file.list"),isTreeTable:!1,api:r,columns:O,pagination:!1,striped:!1,useSearchForm:!0,showTableSetting:!0,bordered:!0,showIndexColumn:!1,canResize:!1,rowKey:"id",actionColumn:{width:100,title:e("common.action"),dataIndex:"action",slots:{customRender:"action"},fixed:void 0}});function c(s){return u(this,null,function*(){const m=b(t.value);m.push(s.fileName);const x=yield ie(m.join("/"));n({title:e("common.info"),content:e("Content.file.deleted")}),o()})}function l(){o()}function _(){t.value.length>0&&t.value.pop(),o()}function k(s){return u(this,null,function*(){const m=b(t.value);m.push(s.fileName),yield ee(m.join("/")),o()})}function I(s){return u(this,null,function*(){const m=b(t.value);m.push(s.fileName),yield te(m.join("/")),o()})}function N(s){t.value.push(s.fileName),o()}function S(s){i.value=[],o()}return{t:e,expandAll:d,collapseAll:a,registerTable:p,handleDelete:c,handleSuccess:l,handleUp:_,handleUnzip:I,handleZip:k,handleDown:N,uploadApi:G,handleUploadChange:S,uploadedList:i,pathList:t,endsWith:q}}});function ne(e,i,t,n,r,p){const o=f("BasicUpload"),d=f("a-button"),a=f("TableAction"),c=f("BasicTable");return M(),L("div",null,[g(c,{onRegister:e.registerTable},{toolbar:C(()=>[g(o,{api:e.uploadApi,maxNumber:100,uploadParams:{path:e.pathList.join("/")},emptyHidePreview:!0,onChange:e.handleUploadChange,value:e.uploadedList,"onUpdate:value":i[0]||(i[0]=l=>e.uploadedList=l)},null,8,["api","uploadParams","onChange","value"]),e.pathList.length>0?(M(),j(d,{key:0,type:"primary",preIcon:"bi:file-arrow-up",onClick:e.handleUp},{default:C(()=>[H(W(e.t("Content.file.go_parent")),1)]),_:1},8,["onClick"])):P("",!0)]),action:C(({record:l})=>[g(a,{actions:[{icon:"ant-design:delete-outlined",color:"error",popConfirm:{title:"Deletion Confirm",confirm:e.handleDelete.bind(null,l)}},{icon:"ph:file-zip-fill",onClick:e.handleZip.bind(null,l),ifShow:l.directory},{icon:"ph:file-zip-light",onClick:e.handleUnzip.bind(null,l),ifShow:e.endsWith(l.fileName,".zip")},{icon:"tabler:file-arrow-right",onClick:e.handleDown.bind(null,l),ifShow:l.directory}]},null,8,["actions"])]),_:1},8,["onRegister"])])}var ct=Y(oe,[["render",ne]]);export{ct as default};
